# java_basic 

####   如何保证消息的可靠性传输（如何处理消息丢失的问题）？

1）生产者弄丢了数据

    1 事务
    2 开启 confirm 模式

2）rabbitmq 弄丢了数据

    第一个是创建queue的时候将其设置为持久化的，这样就可以保证rabbitmq持久化queue的元数据
    第二个是发送消息的时候将消息的deliveryMode设置为2，就是将消息设置为持久化的，此时rabbitmq就会将消息持久化到磁盘上去
  
3）消费端弄丢了数据
    
    手动 ack 
    test
    
#### 如何保证消息不被重复消费啊（如何保证消息消费时的幂等性）？   
    
    1 你先根据主键查一下，如果这数据都有了，你就别插入了，update一下好吧
    2 比如你是写redis，那没问题了，反正每次都是set，天然幂等性
    3 先根据这个id去比如redis里查一下，之前消费过吗？如果没有消费过，你就处理，
    
#### 如何保证消息的顺序性？
    
    拆分多个queue 一个queue对应一个consumer
    
    
####  rabbitmq 的交换机类型

    Direct   处理路由键 要求该消息与一个特定的路由键完全匹配。这是一个完整的匹配
    
    Fanout   不处理路由键。 你只需要简单的将队列绑定到交换机上
    
    Topic    路由键和某模式进行匹配 此时队列需要绑定要一个模式上。符号“#”匹配一个或多个词，符号“”匹配不多不少一个词
        
    Headers   不处理路由键。而是根据发送的消息内容中的headers属性进行匹配  
    
#### 延时队列

    publisher ---> queue   --->   ttl  -->  dead.queue  --->  subscriber
    

算法 nio  


    
        
        
    
    